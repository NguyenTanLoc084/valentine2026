<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For My Love - Valentine 2026</title>

<style>
html, body {
    margin: 0; width: 100%; height: 100%;
    background: #02010a !important;
    background-image: radial-gradient(circle at center, #0d0015 0%, #02010a 100%) !important;
    overflow: hidden; font-family: 'Segoe UI', Tahoma, sans-serif;
}
canvas { position: fixed; inset: 0; z-index: 1; }

.center { position: fixed; left: 50%; top: 50%; transform: translate(-50%, -50%); z-index: 10; width: 90%; max-width: 720px; }

/* ‚úâÔ∏è PHONG TH∆Ø */
#envelope {
    width: 160px; height: 110px; background: #fdf5e6; border-radius: 8px;
    box-shadow: 0 0 40px rgba(255, 255, 255, 0.1), 0 10px 30px rgba(0,0,0,0.5);
    cursor: pointer; display: none; animation: pulseEnvelope 1.6s infinite;
}
#envelope::before {
    content: ""; position: absolute; top: 0; left: 0;
    border-left: 80px solid transparent; border-right: 80px solid transparent; border-top: 65px solid #ecd9b5; z-index: 2;
}
.heart-seal {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -20%);
    width: 35px; height: 35px; background: #ff4d6d; z-index: 3;
    clip-path: path('M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z');
}
@keyframes pulseEnvelope { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.1); } }

/* üíå B·ª®C TH∆Ø TRONG SU·ªêT */
#letter {
    background: rgba(255, 255, 255, 0.05); 
    backdrop-filter: blur(15px); 
    -webkit-backdrop-filter: blur(15px);
    border-radius: 12px; overflow-y: auto; max-height: 85vh; display: none; cursor: pointer; 
    box-shadow: 0 30px 80px rgba(0, 0, 0, 0.5); z-index: 15;
    border: 1px solid rgba(255, 255, 255, 0.15);
    transition: all 0.8s cubic-bezier(0.6, -0.28, 0.735, 0.045);
}

#letter.fade-out, #photo.fade-out {
    transform: translate(-50%, -50%) scale(0) !important;
    opacity: 0 !important;
}

.letter-header { 
    background: rgba(255, 255, 255, 0.05); 
    padding: 12px 20px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); 
    font-size: 1.1rem; font-weight: bold; color: #fff;
}

#letterContent { display: flex; flex-direction: row; min-height: 300px; }

/* Mobile Adaptive */
@media (max-width: 600px) {
    #letterContent { flex-direction: column-reverse; } /* ƒê∆∞a ·∫£nh l√™n tr√™n ch·ªØ tr√™n mobile */
    .text-section { border-right: none !important; border-top: 1px solid rgba(255, 255, 255, 0.1); padding: 25px !important; }
    #loveText { font-size: 1rem !important; line-height: 1.6 !important; }
    .photo-section { padding: 20px !important; }
    #photoSlot { width: 180px !important; height: 220px !important; }
}

.text-section { flex: 1.4; padding: 35px; border-right: 1px solid rgba(255, 255, 255, 0.1); }
#loveText { line-height: 1.8; font-size: 1.1rem; color: #fff; opacity: 0; transition: 1s ease; text-shadow: 1px 1px 5px rgba(0,0,0,0.5); }
#loveText.show { opacity: 1; }
.gray-box { background: rgba(255, 255, 255, 0.1); padding: 10px; border-radius: 6px; font-size: 0.85rem; color: #ddd; margin-bottom: 20px; }

.photo-section { flex: 1; padding: 25px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(0, 0, 0, 0.15); }
#photoSlot { width: 220px; height: 280px; border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; position: relative; }

/* üñºÔ∏è ·∫¢NH */
#photo {
    position: fixed; left: 50%; top: 50%; width: 300px; height: 300px;
    transform: translate(-50%, -50%) scale(0.5); border-radius: 15px;
    overflow: hidden; opacity: 0; z-index: 100;
    transition: all 1s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
#photo img { width: 100%; height: 100%; object-fit: cover; }
#photo.shrink { 
    width: 200px !important; height: 260px !important; 
    border: 3px solid rgba(255, 255, 255, 0.9); 
    box-shadow: 0 10px 30px rgba(0,0,0,0.5); 
}

/* Fix cho mobile photo shrink */
@media (max-width: 600px) {
    #photo.shrink { width: 180px !important; height: 220px !important; }
}
</style>
</head>
<body>

<canvas id="c"></canvas>
<div id="envelope" class="center"><div class="heart-seal"></div></div>

<div id="letter" class="center">
    <div class="letter-header"> G·ª≠i T∆∞·ªùng Vy ‚ù§Ô∏è</div>
    <div id="letterContent">
        <div class="text-section">
            <div id="loveText">
                <div class="gray-box">G·ª≠i ƒë·∫øn ng∆∞·ªùi con g√°i quan tr·ªçng nh·∫•t c·ªßa anh...</div>
                <p>
                    Valentine n√†y, anh kh√¥ng c·∫ßn socola hay hoa h·ªìng g√¨ c·∫£, v√¨ ch·ªâ c·∫ßn c√≥ em b√™n c·∫°nh l√† m·ªçi ng√†y ƒë·ªÅu tr·ªü n√™n ƒë·∫∑c bi·ªát. 
                    C·∫£m ∆°n em v√¨ ƒë√£ ƒë·∫øn, ·ªü l·∫°i v√† l√†m th·∫ø gi·ªõi c·ªßa anh d·ªãu d√†ng h∆°n. 
                    Ch√∫c t√¨nh y√™u c·ªßa ch√∫ng ta lu√¥n ·∫•m √°p, b√¨nh y√™n v√† ƒë·∫ßy y√™u th∆∞∆°ng.<br><br>
                    Valentine h·∫°nh ph√∫c nh√©, ng∆∞·ªùi anh y√™u<br><br>
                    <span style="color: #ff4d6d; font-weight: bold; font-size: 1.3rem; text-shadow: 0 0 15px rgba(255,77,109,0.8);">
                        üå∏ M√£i y√™u  üå∏
                    </span>
                </p>
            </div>
        </div>
        <div class="photo-section">
            <div id="photoSlot"></div>
        </div>
    </div>
</div>

<div id="photo"><img src="lover.jpg"></div>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
let width, height, stars = [], step = 0, time = 0;
let breaking = false;

// Gi·∫£m s·ªë l∆∞·ª£ng h·∫°t tr√™n mobile ƒë·ªÉ m∆∞·ª£t h∆°n
const isMobile = window.innerWidth < 600;
const COUNT = isMobile ? 400 : 750; 
const HEART_SIZE = isMobile ? 8 : 12;

function resize() { 
    width = canvas.width = window.innerWidth; 
    height = canvas.height = window.innerHeight; 
}
window.addEventListener('resize', resize); resize();

function heartShape(t) { return { x: 16 * Math.pow(Math.sin(t), 3), y: -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t)) }; }

function initStars() {
    stars = [];
    for (let i = 0; i < COUNT; i++) {
        const t = Math.random() * Math.PI * 2, pos = heartShape(t), z = (Math.random() - 0.5) * 2;
        stars.push({ x: Math.random() * width, y: Math.random() * height, tx: pos.x, ty: pos.y, tz: z, vx: 0, vy: 0, size: Math.random() * (isMobile ? 1.5 : 2.5) + 0.5, a: Math.random() * Math.PI * 2, speed: 0.02 + Math.random() * 0.03 });
    }
}
initStars();

document.onclick = () => {
    step++;
    if (step === 2) document.getElementById("envelope").style.display = "block";
    if (step === 3) {
        document.getElementById("envelope").style.display = "none";
        document.getElementById("letter").style.display = "block";
    }
    if (step === 4) {
        const photo = document.getElementById("photo");
        const slot = document.getElementById("photoSlot");
        const rect = slot.getBoundingClientRect();
        photo.style.opacity = "1";
        photo.style.transform = "translate(-50%, -50%) scale(1)";

        setTimeout(() => {
            photo.classList.add("shrink");
            photo.style.left = (rect.left + rect.width / 2) + "px";
            photo.style.top = (rect.top + rect.height / 2) + "px";
            photo.style.transform = "translate(-50%, -50%)"; 
            document.getElementById("loveText").classList.add("show");
        }, 1000);
    }
    if (step === 5) {
        breaking = true;
        const letter = document.getElementById("letter");
        const photo = document.getElementById("photo");
        letter.classList.add("fade-out");
        photo.classList.add("fade-out");
        
        stars.forEach(s => {
            const angle = Math.random() * Math.PI * 2;
            const force = Math.random() * 30 + 10;
            s.vx = Math.cos(angle) * force;
            s.vy = Math.sin(angle) * force;
        });

        setTimeout(() => {
            step = 0; breaking = false;
            letter.style.display = "none"; photo.style.opacity = "0";
            letter.classList.remove("fade-out"); photo.classList.remove("fade-out", "shrink");
            photo.style.left = "50%"; photo.style.top = "50%";
            document.getElementById("loveText").classList.remove("show");
            initStars();
        }, 1500);
    }
};

function draw() {
    ctx.clearRect(0, 0, width, height); 
    time += 0.045; 
    const beat = (step > 0 && step < 5) ? (1 + Math.sin(time * 2.5) * 0.1) : 1;

    stars.forEach(s => {
        s.a += s.speed;
        if (breaking) {
            s.x += s.vx; s.y += s.vy;
            s.vx *= 0.95; s.vy *= 0.95;
        } else if (step === 0) {
            let tx = s.x + Math.cos(s.a) * 1.5;
            let ty = s.y + Math.sin(s.a) * 1.5;
            s.x += (tx - s.x) * 0.08; s.y += (ty - s.y) * 0.08;
        } else {
            let tx = (width/2) + s.tx * HEART_SIZE * beat * (1 + s.tz * 0.2);
            let ty = (height/2) + s.ty * HEART_SIZE * beat * (1 + s.tz * 0.2);
            s.x += (tx - s.x) * 0.08; s.y += (ty - s.y) * 0.08;
        }

        const alpha = 0.5 + Math.abs(Math.sin(time + s.a)) * 0.5;
        ctx.beginPath(); 
        ctx.arc(s.x, s.y, s.size * (1 + s.tz * 0.4), 0, Math.PI * 2);
        ctx.fillStyle = `rgba(255, ${80 + s.tz * 60}, ${130 + s.tz * 60}, ${alpha})`;
        
        if(s.tz > 0 && step > 0 && step < 5) { 
            ctx.shadowBlur = isMobile ? 8 : 15; 
            ctx.shadowColor = "rgba(255, 77, 109, 0.6)"; 
        } else { ctx.shadowBlur = 0; }
        
        ctx.fill();
    });
    requestAnimationFrame(draw);
}
draw();
</script>
</body>
</html>
